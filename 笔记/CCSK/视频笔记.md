# 视频笔记

## 第一章 云计算简介与云架构

### 1 学习目标

云理论知识

额外材料

* CSA指南
* 共识评估倡议问卷(CAIQ), 自评估问卷
* 云控制矩阵(CCM), 云的风险和控制措施对应关系
* ENISA风险报告

### 2 

附件**知识点.xlsx**

### 3 学习目标

* 定义云计算和你为什么关注它
* 讨论云计算的不同组件
* 过云参考模型工作并了解个模型下安全该从何介入

### 4 云计算基本概念

* 抽象化
* 自动化(编排)

虚拟化只是抽象化，不具备编排特性。

没有虚拟化，没有云。云利用虚拟化，给客户提供快速虚拟化的能力。

传统虚拟化

* 从物理基础设施抽象出计算，网络与存储资源
* 通常是由管理员手工分配资源
* 不支持自助服务，需要管理员介入
* 由于缺乏自动化而不具备弹性

云计算

* 从屋里基础设施抽象出计算，网络与存储资源（甚至更多）
* 可以自动化并协调资源池的管理（自动编排）
* 自助服务。用户根据策略从自己分配的资源池中获取资源

#### 4.1 云计算是什么

**NIST**

* 云将应用程序和信息资源与底层基础设施以及用于交付它们的机制分开。
* 云描述了由计算，网络，信息和存储资源池组成的服务，应用，信息和基础设施的集合。
* 这些资源可以快速编排，提供，实施，退役，同时实现资源伸缩。
* 云提供按需，按小勇的分配和消费模型。

**NIST**

云计算是一种模型，用于支持无处不在的，便捷的，按需的，广泛网络访问的共享计算资源池（例如网络，服务器，存储，应用程序和服务），这些资源可以在最少的管理，最少的服务商交互的情况下快速提供和发布。

**ISO/IEC**

允许通过网络访问的，可扩展的，弹性的，可共享的物理或虚拟资源池，并按需提供自助服务和管理。

### 5 云计算的潜在收益，NIST云计算模型

#### 5.1 云计算潜在收益

**敏捷+弹性+经济**

* 无资本支出（使用公有云）
* 更敏捷
* 规模无限
* 提升资源利用率
* 客户可控制的迁移
* 弹性（安全性+连续性）
* 按用量付费（经济型）

![](img/1.jpg)

### 6 云基本特征, 资源池化&多租户

#### 6.1 云的五种基本特性

1. 广泛的网络访问（
	* 基于属性的访问控制，传统是基于角色的访问控制
2. 快速弹性
	* 快速灵活地提供服务, 自动快速扩展和释放（收缩）
3. 可测量服务
	* 自动控制和优化资源使用
	* 利用某种抽象界别的计算能力
	* 效用计算 - 只为你使用的部分付费
4. 按需自服务
	* 前提是可以度量（测量） 
	* 使用者可以根据需要自动提供计算能力, 不需要人工交互
5. 资源池化
	* 资源被池化, 并使用多租户的模式对多个客户提供服务（不同的物理和虚拟资源）
	* 位置独立性（客户不能控制资源的精确位置）

#### 6.2 资源池化 和 多租户

* 策略驱动执行
* 分段
* 隔离
* 治理 (合同, SLA)
* 服务级别
* 计费模型

### 7. 云服务模型

* 软件即服务(SaaS)
* 平台即服务(PaaS)
* 基础设施即服务(IaaS)

![](img/2.jpg)

* IaaS: 从租车公司租一辆车，汽车的维修、安检都由租车公司承担。你只需要提供燃料（需要提供操作系统+应用软件）
* PaaS: 除了基础设施（汽车），还为你提供司机。类似出租车。只需要提供目的地，汽车的行驶和运行都有司机决定。（只需要提供应用软件）。
* SaaS:类似于做轨道交通， 一切都是由别人控制。只有较少的定制化功能。

#### 7.1 IaaS

* 提供处理，存储，网络和其他基础计算资源
* 用户可以部署和运行任意软件
	* 包括操作系统和应用程序

![](img/3.jpg)

IaaS（Infrastructure as a service – 基础设施即服务）：用户可以在云服务提供商提供的基础设施上部署和运行任何软件，包括操作系统和应用软件。用户没有权限管理和访问底层的基础设施，如服务器、交换机、硬盘等，但是有权管理操作系统、存储内容，可以安装管理应用程序，甚至是有权管理网络组件。简单的说用户使用IaaS，有权管理操作系统之上的一切功能。我们常见的IaaS服务有虚拟机、虚拟网络、以及存储。

#### 7.2 PaaS

* 应用开发框架，中间件能力，以及数据库，消息，队列等功能
* 将用户创建或获取的服务部署到云基础设施
* 使用云提供者支持的编程语言和工具创建应用

![](img/4.jpg)

PaaS（Platform as a service – 平台即服务）：PaaS给用户提供的能力是使用由云服务提供商支持的编程语言、库、服务以及开发工具来创建、开发应用程序并部署在相关的基础设施上。用户无需管理底层的基础设施，包括网络、服务器，操作系统或者存储。他们只能控制部署在基础设施中操作系统上的应用程序，配置应用程序所托管的环境的可配置参数。常见的PaaS服务有数据库服务、web应用以及容器服务。成熟的PaaS服务会简化开发人员，提供完备的PC端和移动端软件开发套件（SDK），拥有丰富的开发环境（Inteli、Eclipse、VS等），完全可托管的数据库服务，可配置式的应用程序构建，支持多语言的开发，面向应用市场。

#### 7.3 SaaS

* 用户使用服务商的应用程序
* `SaaS`不一定运行在`IaaS`或`PaaS`上, 当仍然需要具备云的基本特征
* 用户不能管理或控制底层基础设施包括网络，服务器，操作系统，存储，甚至个人应用能力

![](img/5.jpg)

SaaS（Software as a Service – 软件即服务）：SaaS给用户提供的能力是使用在云基础架构上运行的云服务提供商的应用程序。可以通过轻量的客户端接口（诸如web浏览器（例如，基于web的电子邮件））或程序接口从各种客户端设备访问应用程序。 用户无需管理或控制底层云基础架构，包括网络，服务器，操作系统，存储甚至单独的应用程序功能，可能的例外是有限的用户特定应用程序配置设置。类似的服务有：各类的网盘(Dropbox、百度网盘等)，JIRA，GitLab等服务。而这些应用的提供者不仅仅是云服务提供商，还有众多的第三方提供商（ISV: independent software provider）。

**元数据**

* 数据字典
* 注册表

### 8 云部署模型

* 公有云
* 社区云
* 私有云
* 混合云
	* 直连网络通道
	* 虚拟网络通道

![](img/6.jpg)

### 9 逻辑模型及共享责任模型

* 数据和信息
* 应用组件/服务
* 管理平面
* 核心基础设施

![](img/7.jpg)

* Inforstructure
	* 信息
* Applistructure
	* 应用
* Infrastructure
	* 计算，网络，存储 物理资源虚拟化
* Metastructur
	* 协议，机制。提供基础结构层和其它层之间的**接口**。实际就是**管理平面**。

共享责任模型

![](img/8.jpg)

![](img/9.jpg)

* IaaS 消费者责任
* SaaS 提供者责任

### 10 云安全及模块总结

* 确定需求
* 选择提供者，服务和部署模型
* 定义架构
* 访问安全控制
* 确定控制差距
* 设计和实施控制
* 管理变更

## 第二章 云计算基础设施安全

### 11 学习目标

* 理解云基础设施的组件
* 评估虚拟网络和工作负载的安全影响
* 了解使用云基础设施的安全优势和劣势
* 评估如何保护云管理平面
* 学习如何管理云计算的业务连续性

![](img/10.jpg)

### 12 保护基础设施

* 基础设施组件
* 虚拟机管理程序
* 网络
* 管理平面

### 13 保护虚拟网络

![](img/11.jpg)

* 要使用单独的物理网络
* 将云网络与局域网隔离

#### 13.1 VLAN 和 SDN

* LVAN
	* 利用现有网络中的技术
	* 转为单租户环境中的网络分段设计而不是为隔离租户
	* 作为安全屏障是无效的
	* 如果在云环境中在规模上就要有性能和地址空间的限制
* SDN
	* 软件定义网络实现了控制平面与底层硬件的解耦
	* 从传统的LAN限制中抽象出虚拟网络
	* 非常灵活(如在相同的物理硬件上重叠IP地址范围)
	* 多种实现，标准和专有的
	* 可以实现有效安全屏障

#### 13.2 SDN 安全优势

* 更容易隔离
* SDN 防火墙/安全组
* 拓扑不受物理结构限制
* 基于标记和其他上下文的安全策略和控制

#### 13.3 软件定义边界 SDP

结合`SDN`做网络安全管理

#### 网络安全建议

* 建议使用`SDN`
* 为多个虚拟网络和多个云账户/分段使用`SDN`功能，以增强网络隔离
* 与传统的数据中心对比，独立的账户和虚拟网络极大地限制了危害范围
* 在云防火墙上实现默认拒绝
* 基于每个工作负载还不是基于每个网络应用云防火墙
* 尽可能使用云防火墙策略限制统一虚拟子网中的工作负载之间的通信，比如使用安全组

### 14 保护公计算工作负载

工作负载

* 虚拟机
* 容器
* 基于平台（如`paas`上的存储过程，如数据库）
* 无服务器（代码执行）

![](./img/12.jpg)

**不可变** 使用`image`镜像**替换**代替**升级**

#### 14.1 不可变的

* 基于镜像自动部署(例如使用自动伸缩组)
* 登录已禁用，因为更改不会传播到其他实例
* 用新版本替换旧版本，而不是对旧版本打补丁
* 非常容器实现安全加固(例如禁用`SSH`)

#### 14.2 自动配置管理

* 使用基于模板/策略的工具(`Chef/Puppet/Ansible/Salt`)
* 禁用手动更改，因为自动化会覆盖

#### 14.3 标准/长时间运行

* 像传统服务器一样管理

### 15 管理平面

* 关键功能
	* 提供资源
	* 启动/停止/终止
	* 配置资源
* 安全注意事项
	* 身份验证
	* 访问控制
	* 日志/监控

访问和凭证, `WEB`和`APIs`

#### 15.1 `ROOT`账户安全

* 启用硬件多因素身份验证(`MFA`)
	* 存储在一个锁定的中心位置
* 使用孤立的凭证
	* 云账户不要用作其他用途
	* 使用带有随机种子的名称来减少网络钓鱼
* 使用账户安全问题
	* 安全地记录和存储账户安全问题及其答案
* 除紧急情况外，切勿使用`root`账户

### 16 业务连续性和灾难恢复

关键方面

* 为提供者服务中断作准备
* 提供者/平台内的连续性
* 可移植性

**架构最重要**

## 第三章 管理云计算的安全性和风险

### 17 学习目标

质量，风险和符合性（GRC）。

### 18 治理

云治理工具

* 合同
* 提供者评估
* 合规性报告

合同是将治理扩展到业务合作伙伴和提供者的主要工具。

组织的治理将确定并定义其风险承受能力。

迁移到云并不会改变风险承受能力，只会改变风险管理方式。

永远不可能将风险管理的总体责任和义务外包。

风险可以外包，但是职责是自己的。

### 19 风险管理

风险评估：信息的价值越高，确保风险得到适当评估的成本越高。

权衡：

* 少：
	* 物理控制资产
	* 需要管理提供者接受的风险
* 多：
	* 依赖SLA和合同
	* 要求管理好（供应商）关系并保持最新
	* 用评估代替测试

### 20 治理与风险的建议

行业实践标准：CSA CCM

风险只会降低，不会消除。

### 21 法律

#### 21.1 信息管理法律责任

* 提供者
	* 对分包商的行为负责
	* 负责遵守本地区的现行法律
* 客户
	* 作为最终用户信息的管理员
	* 负责根据他们所处辖区的实情保护信息
* 最终用户
	* 信息所有者
	* 负责监控信息滥用

#### 21.2 位置和管辖

* 数据在服务时位于何处
* 提供者的匿名性或可变性
* 位置的匿名性或可变性

#### 21.3 相关全球法律要求样本

* 欧盟：GDPR
* 儿童网络隐私保护方案：GLBA/HIPPA/COPPA
* 第三方支付行业是标准: PCI-DSS
* 日本: PIPA
* 澳大利亚: PRIVACY ACT

### 22 合规和审计

* 合规性验证了对公司业务的了解和遵守
* 审计是证明是否合规的关键工具 

工具的合规性

* 审计日志
* 活动报告
* 系统配置细节
* 变更管理细节

### 23 CSA工具，使用认识CCM

**CCM**做什么

**指南**怎么做

16个控制域

* AIS 应用安全
* AAC 审计计划
* BCR 业务连续性
* CCC 变更控制与配置管理
* DSI 数据安全，信息生命周期管理
* DCS 数据中心安全
* EKM 加密和密钥管理
* GRM 治理和风险管理
* HRS 人力资源安全
* IAM 身份与访问管理
* IVS 基础设施与虚拟化安全
* IPY 互操作性与可移植性
* MOS 移动安全
* EEF 安全时间管理
* STA 供应链管理
* TVM 威胁和漏洞管理

### 24 ENSIA风险评估报告

#### 24.1 云计算的最大安全受益

* 安全和规模效益
* 安全导致市场差异化
* 快速智能的资源伸缩
* 审计和取证
* 资源集中的优势
* 更及时的发布更新与有效的默认安全配置
* 标准化的安全管理接口
* 审计和SLA促进更好的风险管理

#### 24.2 云计算的最高安全风险

* 治理缺失
* 厂商锁定
* 隔离失败
* 合规风险
* 管理平面缺陷
* 数据保护
* 不安全或不完整的数据删除
* 恶意的内部人员

#### 24.3 政策和组织风险

* R1 锁定
* R2 治理确实
* R3 合规挑战
* R4 由于共同承担的活动造成的业务声誉损失
* R5 云服务终止或失效
* R6 云服务商并购
* R7 供应链故障

#### 24.4 技术风险

* R8 资源耗尽
* R9 隔离失败
* R10 云提供者恶意内部人员
* R11 管理平面缺陷
* R12 拦截传输中的数据
* R13 上传下载时云内的数据泄露
* R14 数据缺失或无效删除
* R15 分布式拒绝服务DDOS
* R16 经济拒绝服务EDOS（没有对资源使用调整限制资源恶意使用从而产生大量费用） 
* R17 加密密钥丢失
* R18 进行恶探测或扫描
* R19 服务引擎损坏
* R20 客户加固程序与云环境之间的冲突

#### 24.5 法律风险

* R21 传唤与电子取证
* R22 管辖权变更的风险
* R23 数据保护风险
* R24 许可风险: 许可条件

#### 24.6 并非云中特有的风险

* R25 网络重点观
* R26 网络管理
* R27 篡改网络流量
* R28 特权升级
* R29 社会工程攻击
* R30 操作日志的丢失或损坏
* R32 安全日志的丢失或损坏
* R32 备份挂失，被盗
* R33 未经授权的物理访问
* R34 计算机设备失窃
* R35 自然灾害

## 第四章 云计算的数据安全

### 25 云数据存储 和 将数据迁入云中

安全性关注点

* 访问控制
* 加密
* 正确配置

云数据存储类型

* 卷，虚拟的硬盘驱动器
* 对象，API的弹性文件系统，“文件数据库”
* 数据库
* 应用程序/平台，SAAS

数据存储：比特拆分，数据分布。一个文件分散成多个碎片，存储到不同的磁盘上。攻击者获取到一个磁盘，不能还原一个文件。

### 26 保护云中的数据

访问控制是首要的数据安全控制

创建平台的授权矩阵

管理分三层

* 管理平面
* 公开及内部共享控制
* 应用级控制，自己的应用程序

### 26.1 数据加密

1. 应用程序
2. 数据库
3. 文件/API
4. 卷存储

### 26.2 云密钥管理

* HSM/设备
* 虚拟设备/软件
* 软硬件混合
* 云服务

密钥管理与数据是分开的

### 27 其他数据安全选项

利用架构减少攻击面

#### 27.1 处理加密还要做什么

* 审计/监控/告警
* 提供者专用的控制
* 数据防泄露
* ERM/DRM

### 28 数据安全生命周期

* 数据安全生命周期是有助于安全控制建模的工具
* 颗粒度不要太细否则会因为太复杂而难以建模。关注大局。
* 利用生命周期来判断数据流
* 用它映射出数据“可以”如何被使用以及它“应该”如何被使用
* 当可以执行本来不应该允许的操作时，需要插入安全控制

#### 28.1 生命周期的六个阶段

* 创建
* 存储
* 使用
* 共享
* 存档
* 销毁

#### 28.2 其他

内部和外部访问有不同的安全策略

**访问控制决策的授权矩阵**

## 第五章 保护云应用和用户

### 29 应用安全

**管理平面/元基础设施也在应用安全范围内**

测试不是与安全开发或安全部署孤立的阶段。这些阶段相互重叠，并没有明确的界限。

#### 29.1 安全软件开发生命周期 （SSDLC）

* 微软的安全开发生命周期
* NIST 800-64
* ISO/IEC 27034
* 其他组织, OWASP

敏捷版 和 瀑布流版

### 30 安全软件开发生命周期（SSDLC）

#### 30.1 应用安全阶段

* 安全设计 和 开发
	* 培训
	* 软件开发生命周期 SDLC
	* 预部署测试
* 安全部署
	* 代码评审
	* 静态应用安全测试/动态应用安全测试
	* 漏洞评估
	* 部署
* 安全运维
	* 变更管理
	* Web应用防火墙/App防御
	* 持续评估
	* 活动监控

#### 30.2 安全设计和开发

* 培训
	* 安全编码
	* 编写安全测试用例
	* 云提供者/平台技术培训
* 定义
	* 编码标准
	* 安全功能需求
* 设计
	* 威胁建模
	* 安全设计
* 开发
	* 代码评审
	* 单元测试
	* 静态分析
	* 动态分析
* 测试
	* 漏洞评估
	* 动态分析
	* 功能测试
	* QA

#### 30.3 威胁建模样例: STRIDE 模型

* 欺骗，身份认证
* 篡改，数字签名，哈希
* 抵赖，审计日志
* 信息泄露，加密
* 拒绝服务，可用性
* 提权，授权

#### 30.4 其他

代码评审是手动的

* 漏洞扫描: 面
* 渗透测试: 点

漏洞评估集成到 CI/CD 管道中，基础设施即代码

### 31 DevOps和持续集成，持续部署

安全优势

* 更加标准化
* 自动化测试
* 增加审计
* 利用自动化技术来提升安全运营

#### 31.1 基础设施即代码

云修改基础设施像改代码一样修改

### 32 设计与架构

云如何影响

* 默认隔离
* 不可变基础设施
* 微服务使用的增加
* PaaS 和 无服务器架构

### 33 身份和访问管理



### 34 关于身份的其他决定，身份管理建议

## 第六章 云安全运行

### 35 学习目标

### 36 云提供者的关键安全能力及需要提供的内容

### 39 准备 CCSK 考试