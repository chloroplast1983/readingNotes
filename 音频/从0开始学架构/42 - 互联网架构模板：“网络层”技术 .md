# 42 | 互联网架构模板：“网络层”技术 

## 笔记

**单个系统的高可用和高性能并不等于整体业务的高可用和高性能**, **站在更高的角度去设计(网络), 站在网络层的角度整体设计架构**.

### 负载均衡

#### 1. DNS

**地理级别负载均衡**

* 优点
	* 通用
	* 成本低
* 缺点
	* 缓存的时间比较长
	* 不够灵活(不能感知后端服务器的状态)

`HTTP-DNS`

* 灵活: 根据业务设置各种策略
* 可控: 自己开发系统
* 及时: 快速更新
* 开发成本高
* 侵入性: 需要`App`基于`HTTP-DNS`进行改造

#### 2. Nginx, LVS, F5

**机器级别负载均衡**

* Nginx: 7层
	* 5万/秒
* LVS: **内核**的4层
	* 10万/秒
* F5: **硬件**的4层
	* 百万/秒

### CDN

**空间换时间**, 解决用户网络访问的**最后一公里**效应.

将内容缓存在离用户最近的地方, 用户访问的是缓存内容, 而不是站点实时的内容.

CDN请求流程示意图

![](./img/42_01.png)

CDN体系

* 分布式存储
* 全局负载均衡
* 网络重定向
* 流量控制

### 多机房

* 同城多机房
	* 搭建私有高速网络, 基本可以做到和同机房一样的效果
* 跨城多机房
	* **不需要**数据的实时强一致性
* 跨国多机房
	* 备份
	* 服务本国用户

### 多中心

* 多机房
	* 灾备
* 多中心
	* 每个中心都同时对外提供服务
		* 数据一致性
		* 数据事务性
		
## 扩展