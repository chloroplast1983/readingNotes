# 28 | 业务高可用的保障：异地多活架构

## 笔记

### 应用场景

#### 定义

异地: 地理位置上不同的地方.

多活: 不同地理位置上的系统都能够提供业务服务.

#### 活

* 正常情况下, 用户无论访问哪一个地点的业务系统, 都能够得到正确的业务服务.
* 某个地方业务异常的时候, 用户访问其他地方正常的业务系统, 能够得到正确的业务服务.

#### 活 和 备

备是备份, 正常情况下对外是不提供服务的. 如果需要提供服务, 需要人工干预和操作.

#### 异地多活的代价

* 复杂度会发生质变
* 成本会上升

### 架构模式

#### 同城异区

业务部署在同一个城市不同区的多个机房. 两个机房用专用的高速网络连接在一起.

应对**机房级别**故障的最优架构.

#### 跨城异地

业务部署在不同城市的多个机房. **架构设计上可以将两个机房当作本地机房来设计**.

问题:

* **两个机房距离远, 网络传输速度会降低**
* 中间传输各种不可控因素非常多.
	* 光纤挖断
	* 骨干网故障
	* ...

两个机房, 数据短时间内不一致的情况下, 还能够正常提供业务:

* 强一致性数据如金融数据, 一般只能采用同城异区架构
* 弱一致性数据采用跨城异地

#### 跨国异地

业务部署在不同国家的多个机房.

应用场景:

* 为不同地区用户提供服务
	* 中国亚马逊不能登录美国亚马逊账户
* **只读**类业务做多活
	* 搜索数据有短暂延时性可以接受, 因为不需要搜索到最新的实时资料

## 扩展